<div class="space-y-6 animate-in slide-in-from-bottom-4 duration-500">
  <header>
    <h2 class="text-2xl font-bold text-white mb-2">Escàner de Vulnerabilitats</h2>
    <p class="text-slate-400">Selecciona el tipus d'anàlisi i l'objectiu.</p>
  </header>

  <div class="bg-slate-900 p-6 rounded-xl border border-slate-800 shadow-2xl">
    @if (isScanning()) {
    <!-- PANTALLA D'ANIMACIÓ GRACIOSA -->
    <div
      class="flex flex-col items-center justify-center py-16 text-center animate-in fade-in duration-700"
    >
      <div class="relative w-40 h-40 mb-8 flex items-center justify-center">

        <div class="relative z-10 animate-bounce-slow">
          <div class="text-blue-400 drop-shadow-[0_0_15px_rgba(96,165,250,0.5)]">

            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="80"
              height="80"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <rect
                x="2"
                y="2"
                width="20"
                height="8"
                rx="2"
                ry="2"
                fill="rgba(30, 41, 59, 0.8)"
              ></rect>
              <rect
                x="2"
                y="14"
                width="20"
                height="8"
                rx="2"
                ry="2"
                fill="rgba(30, 41, 59, 0.8)"
              ></rect>
              <line x1="6" y1="6" x2="6.01" y2="6" stroke="#10b981" stroke-width="3"></line>
              <line x1="6" y1="18" x2="6.01" y2="18" stroke="#10b981" stroke-width="3"></line>
            </svg>
          </div>
        </div>

        <div
          class="absolute inset-x-0 h-1 bg-emerald-400 shadow-[0_0_20px_rgba(52,211,153,1)] opacity-80 scan-beam z-20"
        ></div>
      </div>

      <h3 class="text-2xl font-bold text-white mb-2">Escaneig en curs</h3>

      <div class="h-8 flex items-center justify-center">
        <p class="text-emerald-400 font-mono animate-pulse transition-all duration-300">
          > {{ currentFunnyMessage() }}
        </p>
      </div>

      <p class="text-slate-500 text-sm mt-8 max-w-md">
        Pots tancar aquesta pestanya o anar a prendre un cafè. Els resultats es mostraràn a la pestanya de resultats un cop acabat l'escaneig.
      </p>

      <div class="flex gap-4 mt-8">
        <button
          (click)="resetScan()"
          class="px-6 py-3 bg-slate-800 hover:bg-slate-700 text-white rounded-lg font-medium transition-colors border border-slate-700"
        >
          Fer un altre
        </button>
        <button
          (click)="activeTab.set('results')"
          class="px-6 py-3 bg-emerald-600 hover:bg-emerald-500 text-white rounded-lg font-medium transition-colors shadow-lg shadow-emerald-900/20"
        >
          Veure Resultats
        </button>
      </div>
    </div>
    } @else {
    <div class="mb-6">
      <label class="block text-sm font-medium text-slate-400 mb-2">IP de l'objectiu</label>
      <div class="relative">
        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="text-slate-500"
          >
            <rect width="20" height="8" x="2" y="2" rx="2" ry="2" />
            <rect width="20" height="8" x="2" y="14" rx="2" ry="2" />
            <line x1="6" x2="6.01" y1="6" y2="6" />
            <line x1="6" x2="6.01" y1="18" y2="18" />
          </svg>
        </div>
        <input
          type="text"
          placeholder="192.168.x.x"
          class="w-full bg-slate-950 border border-slate-700 text-white rounded-lg pl-10 pr-4 py-3 focus:ring-2 focus:ring-emerald-500 focus:border-transparent outline-none transition-all font-mono"
          [value]="targetUrl()"
          (input)="handleUrlInput($event)"
        />
      </div>
    </div>

    <div class="mb-8">
      <label class="block text-sm font-medium text-slate-400 mb-3">Tipus d'Auditoria</label>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3">
        @for (type of scanTypes; track type.id) {
        <button
          (click)="selectScanType(type.id)"
          [class]="getScanTypeClass(type.id)"
          class="flex flex-col items-center justify-center p-4 rounded-lg border transition-all duration-200 h-32 text-center gap-2 group relative overflow-hidden"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path [attr.d]="type.iconPath"></path>
          </svg>
          <span class="font-bold text-sm">{{ type.name }}</span>
          <span class="text-[10px] opacity-70 leading-tight px-1">{{ type.description }}</span>
        </button>
        }
      </div>
    </div>

    <div class="flex justify-end mb-6">
      <button
        (click)="startScan()"
        [disabled]="!targetUrl()"
        class="w-full md:w-auto bg-emerald-500 hover:bg-emerald-600 disabled:opacity-50 disabled:cursor-not-allowed text-white px-8 py-3 rounded-lg font-bold flex items-center justify-center gap-2 transition-colors shadow-lg shadow-emerald-500/20"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="18"
          height="18"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <polygon points="5 3 19 12 5 21 5 3" />
        </svg>
        INICIAR {{ selectedScan().name.toUpperCase() }}
      </button>
    </div>
    }
  </div>
</div>
